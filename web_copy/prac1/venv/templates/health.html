<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Health</title>
    <link rel="stylesheet" href="{{url_for('static', filename='health.css')}}" />
    <!-- <script type = "text/javascript" src = "{{url_for('static', filename='imgView.js')}}"></script> -->
</head>
<body>
    <div class="header" id="header">
        <h3> hello {{name}} ! </h3>
        <p id="success"></p>
    </div>

        <div class = "left">

    </div>

<div class = "right">

    <h3 class="mt-5"></h3>
    <img src="{{ url_for('video_feed') }}" width="100%"> 

</div>

<script>
    
    var source = new EventSource("/info");
    source.addEventListener('message', function(e) {
        var data = JSON.parse(e.data);
        //document.write("hihi, ");
        if (data.success == 9999){
            document.getElementById("success").innerHTML = "Finish";
            source.removeEventListener('message', arguments.callee)
            setTimeout(function () {
                    location.href = "/timeselect" //timeselect로 이동
                }, 3000); //3초 타이머

        }else{
            document.getElementById("success").innerHTML = "success: " + String(data.success) + ", result: " + String(data.booool);
        }
    },false);
    

    function display_image(src, width, height) {
        var a = document.createElement("img");
        a.src = src;
        a.width = width;
        a.height = height;
        document.body.appendChild(a);
    }

    display_image('{{ src }}', 700, 600);

</script>

</body>
</html>